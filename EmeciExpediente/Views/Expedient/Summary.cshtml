
@{
    ViewBag.Title = "Resumen Clínico";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@using (Html.BeginForm("Summary", "Expedient", FormMethod.Post, new { @id = "SummaryPost"}))
{
    <div class="section-header">
        <h1>Resumen cl&iacute;nico</h1>
        <p class="description">
            Esta informaci&oacute;n puede ser actualizada cada vez que sea necesario
            para as&iacute; mantener al d&iacute;a el expediente.
        </p>
        <div class="section-controls">
            @if (!ViewBag.readOnly)
            {
                <a class="btn btn-primary" href="#" onclick="PostBack()">Guardar Cambios</a>
            }
        </div>
    </div>
    <div class="section-body">
        <div class="panel">
            <div class="panel-heading">
                <h3 class="panel-title">Informaci&oacute;n del paciente</h3>
                Informaci&oacute;n de atenci&oacute;n medica previa a primer
                consulta de internet.
                Incluya al inicial el resumen la fecha de elaboraci&oacute;n.
            </div>
            <div class="panel-body">
                <div class="row">
                    <div class="col-md-12">
                        <div class="form-group">
                            @Html.TextArea("record",
                       (string)ViewBag.record,
                       ViewBag.readOnly ? (object)new { @readonly = "readonly", @class = "form-control", @rows = "10", @style = "min-height:250px" } : new { @class = "form-control", @rows = "10", @style = "min-height:250px" })
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <a href="#" data-toggle="modal" data-target="#dsummary" id="showModal"></a>
    <div class="modal fade" id="dsummary" tabindex="-1" role="dialog" aria-labelledby="dsummary" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="glyphicon glyphicon-remove"></i></button>
                    <h4 class="modal-title" id="myModalLabel">Resumen</h4>
                </div>
                <div class="modal-body">
                    <p>
                        ¡Se actualizaron los datos!
                    </p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>
}


<script>
    function PostBack(element)
    {
        $('#SummaryPost').submit();
    }

    $(function () {
        var postBack = @IsPost.ToString().ToLower();
        if (postBack){
            $('#showModal').trigger('click', function(){});
        }
    })
</script>